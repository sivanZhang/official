{% extends 'base.html' %} {% block css %}
<link href="/static/products/css/products.css" rel="stylesheet"> {% endblock %} {% block content %}
<input type="hidden" id="productid" value="{{product.id}}" />
<div class="container main-container">
    <div class="row">
        <div class="col-sm-4 col-md-4">

            <!-- 商品图片展示 -->
            <div class="img_magnify">
                <img id="big_img" src="" />
            </div>
            <ul class="thumbnail_list">
                {% for pic in product.productpic_set.all %}
                <li>
                    <a href="#" class="thumbnail thumbnail_custom">

                        <img src="{{mediaroot}}{{pic.url}}" alt="缩略图">

                    </a>
                </li>
                {% endfor %}
            </ul>
            <!-- 商品图片展示 完！！！ -->

            <!-- 分享等功能 -->
            <div class="action">
                <i class="fa fa-share-alt" aria-hidden="true">分享</i>
                <i class="fa fa-star" aria-hidden="true">收藏</i>
            </div>
            <!-- 分享等功能 完！！！ -->

        </div>

        <!-- 型号选择和购买 -->
        <div class="col-sm-8 col-md-8 shop">

            <div class="item_name">
                {{product.title|truncatechars:"100"}}
            </div>
            <div class="item_msg">
                {{product.description|default:''}} {{product.adaptorrule_set.all.0.name }} {{product.adaptorrule_set.all.0.unit }}
            </div>
            <div>
                <span class="property_name">价格：</span>
                <i class="fa fa-jpy price" aria-hidden="true"></i>
                <span class="price" id="total_price">
                    {{product.adaptorrule_set.all.0.price }}
                </span>
            </div>


            <div class="rule_wrap">
                <span class="property_name">选择型号：</span>
                <table class="table table-bordered table-hover">
                    {% if product.adaptorrule_set.all %}
                    <tr>
                        <th>规格</th>
                        <th>价格</th>
                        <th>库存</th>
                        <th>单位</th>
                    </tr>
                    {% for rule in product.adaptorrule_set.all %}
                    <tr class="rule_tr" ruleid="{{rule.id}}">
                        <td class="rule_name">{{rule.name}}</td>
                        <td class="unit-price">{{rule.price}}</td>
                        <td class="stock">{{rule.available_inventory}}</td>
                        <td>{{rule.unit}}</td>
                    </tr>
                    {% endfor %} {% endif %}
                </table>
            </div>
            <div class="font-grey">
                <span class="property_name">库存：</span>
                <span class="stock_copy">--</span>
            </div>

            <div class="clearfix">

                <div class="font-grey pull-left property_name">数量：</div>
                <div class="btn-group btn-group-sm pull-left" role="group">
                    <button class="btn btn-default addition">+</button>
                    <div class="carnum" id="carnum">1</div>
                    <button class="btn btn-default subtraction">-</button>
                </div>

            </div>

            <div class="submit">
                <button class="btn btn-info pull-left buy-now" type="button">立即购买</button>
                <button class="btn btn-danger add-cart" type="button">加入购物车</button>
            </div>
        </div>
        <!-- 型号选择和购买 完！！！ -->

    </div>

    <!-- 商品信息和评价 -->
    <div class="row">
        <!-- 标签页菜单 -->
        <div class="col-sm-12 col-md-12">
            <ul id="myTab">
                <li class="active">
                    <a href="#details" data-toggle="tab">商品详情</a>
                </li>
                <li>
                    <a href="#rules" data-toggle="tab">规格参数</a>
                </li>
                <li>
                    <a href="#com_wrap" data-toggle="tab">累计评价</a>
                </li>
            </ul>
        </div>
        <div id="myTabContent" class="tab-content">
            <!-- 商品详情 -->
            <div class="col-sm-12 col-md-12 tab-pane fade in active" id="details" role="tabpanel">
                <div class="illustrate">
                    {{ product.detail|default:''|safe}}
                </div>
                {% include 'recommend.html' %}
            </div>
            <!-- 规格参数 -->
            <div class="col-sm-12 col-md-12 tab-pane fade" id="rules" role="tabpanel">
                    
                            <table class="table table-bordered">  
                                <tbody class="pro-table"></tbody>
                            </table>
            </div>

            <!-- 累计评价 -->
            <div class="col-sm-12 col-md-12 tab-pane fade" id="com_wrap" role="tabpanel">
            </div>
        </div>
        <!-- 商品信息和评价 完 -->
    </div>
</div>
<!-- 制顶 -->
<div id="to_top" title="回到顶部"><i class="fa fa-arrow-up" aria-hidden="true"></i></div>
{% endblock %} {% block js %}
<script type="text/javascript " src="/static/js/login.js "></script>
<script type="text/javascript " src="/static/products/js/detail.js"></script>
<script>
    var items = {{ product.parameters | safe }};
    var html = '';
    for (var i = 0; i < items.length; i++) {
        html = ' <tr>' +
            '<td class="key">' + items[i]['key'] + '</td>' +
            '<td class="value">' + items[i]['value'] + '</td>' +
            '</tr>';
        $('.pro-table').prepend(html);
    }
</script>
{% endblock %}